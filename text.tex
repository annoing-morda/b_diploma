\documentclass[pdftex,ptm,12pt,a4paper]{report}
\renewcommand{\baselinestretch}{1.5}
\setcounter{secnumdepth}{5}

% PDF search & cut'n'paste
\usepackage{cmap}

% Cyrillic support
\usepackage{mathtext}
\usepackage[T1,T2A]{fontenc}
\DeclareSymbolFont{T2Aletters}{T2A}{cmr}{m}{it}
\usepackage[utf8]{inputenc}

\usepackage[bottom=20mm,top=20mm,right=20mm,left=30mm,headsep=0cm,nofoot]{geometry}

\makeatletter
\renewcommand*{\ps@plain}{%
  \let\@mkboth\@gobbletwo
  \let\@oddhead\@empty
  \def\@oddfoot{%
    \reset@font
    \hfil
    \thepage
    % \hfil % removed for aligning to the right
  }%
  \let\@evenhead\@empty
  \let\@evenfoot\@oddfoot
}
\makeatother
\pagestyle{plain}
\setlength{\footskip}{30pt}

\newenvironment{Proof} % имя окружения
  {\par\noindent{\bf Доказательство.}} % команды для \begin
  {\hfill$\scriptstyle\blacksquare$}

\usepackage[pdftex]{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[english, russian]{babel}
    \addto{\captionsenglish}{\renewcommand{\bibname}{Литература}}
    \addto\captionsenglish{\renewcommand{\figurename}{Рис.}}
    \addto\captionsenglish{\renewcommand{\contentsname}{Содержание}}
    \addto\captionsenglish{\renewcommand{\proofname}{Доказательство}}
\usepackage{hyperref}
\usepackage{url}
\usepackage{abstract}
\usepackage{float}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsmath}
\renewcommand*{\proofname}{Доказательство}
\usepackage{indentfirst}
\usepackage{color}
\usepackage{natbib}
\usepackage{bbm, dsfont}
\usepackage{titlesec}
\usepackage{caption}

% Detect whether PDFLaTeX is in use
\usepackage{ifpdf}

% Fix links to floats
\usepackage[all]{hypcap}

%Formula packages
\usepackage{amsmath}

% Chapter
\makeatletter
\renewcommand{\@chapapp}{Часть}
\makeatother

\titleformat{\chapter}[display]
{\normalfont\huge\bfseries}
{\chaptertitlename\ \thechapter}{0.5ex}{}[]

\titlespacing*{\chapter}{0pt}{0pt}{40pt}

% Rule for Title Page
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\begin{document}

\begin{titlepage}
\newpage

\begin{center}{\small
МИНИСТЕРСТВО ОБРАЗОВАНИЯ И НАУКИ РОССИЙСКОЙ ФЕДЕРАЦИИ \\
\vspace{0.1cm}
ФЕДЕРАЛЬНОЕ ГОСУДАРСТВЕННОЕ АВТОНОМНОЕ  \\*
ОБРАЗОВАТЕЛЬНОЕ УЧРЕЖДЕНИЕ ВЫСШЕГО ОБРАЗОВАНИЯ \\*
"МОСКОВСКИЙ ФИЗИКО-ТЕХНИЧЕСКИЙ ИНСТИТУТ \\*
(ГОСУДАРСТВЕННЫЙ УНИВЕРСИТЕТ)" \\*
\vspace{0.1cm}
ФАКУЛЬТЕТ ИННОВАЦИЙ И ВЫСОКИХ ТЕХНОЛОГИЙ \\*
КАФЕДРА ФИЗИКО-ТЕХНИЧЕСКОЙ ИНФОРМАТИКИ \\*
\hrulefill
}
\end{center}

\begin{center}
\Large Выпускная квалификационная работа (бакалаврская работа)
\end{center}

\vspace{1em}

\begin{center}
\Large НА ТЕМУ:
\linebreak
\textsc{\large{\textbf{ПРОВЕРКА НАЛИЧИЯ ПЕРЕСЕЧЕНИЯ ТЕЛ В ТРЕХМЕРНОМ ПРОСТРАНСТВЕ}}}
\end{center}

\vspace{4em}

\begin{flushleft}
Студент \hrulefill Морозов Дмитрий Антонович \\
Научный руководитель \hrulefill Гуревич Михаил Исаевич\\
Зав. кафедрой \hrulefill Бутко Андрей Борисович\\
\end{flushleft}

\vspace{\fill}

\begin{center}
МОСКВА, 2017
\end{center}

\end{titlepage}

\tableofcontents

\clearpage

\chapter{Введение}
\section{Необходимые леммы}
\newtheorem{Lem}{Лемма}
\begin{Lem}\label{conv}
  Про выпуклый многоугольник и круг
\end{Lem}
\begin{Lem}\label{chstr4edge}
  Про замену строчек в матрице для получения задачи квадртичного программирования
\end{Lem}
\begin{Lem}\label{chstr4check}
  Пусть система
  \begin{equation}\label{proof1stsys}
    \begin{pmatrix}
     x_a & x_b & x_c & \vrule & -x_o\\
     y_a & y_b & y_c & \vrule & -y_o \\
     z_a & z_b & z_c & \vrule & -z_o
     \end{pmatrix}
  \end{equation}
  имеет единственное решение. Тогда система
  \begin{equation}\label{proo2ndsys}
    \begin{pmatrix}
     x_a & x_b & x_c & \vrule & -x_o\\
     y_a & y_b & y_c & \vrule & -y_o \\
     0   & 0   & 1   & \vrule & 1
     \end{pmatrix}
  \end{equation}
  также имеет единственное решение.
\end{Lem}
\begin{Proof}
  Так как система \ref{proof1stsys} имеет единственное решение,
  \[
  rk \begin{pmatrix}
   x_a & x_b & x_c \\
   y_a & y_b & y_c \\
   z_a & z_b & z_c
   \end{pmatrix} = 3,
  \]
  так как по теореме Кронекера-Капелли система имеет единственное решение тогда и только тогда, когда ранг расширенной матрицы равен рангу основной
  матрицы и равен числу аргументов
  \[
    det \begin{pmatrix}
        x_a & x_b & x_c \\
        y_a & y_b & y_c \\
        0   & 0   & 1
        \end{pmatrix} = det
            \begin{pmatrix}
              x_a & x_b \\
              y_a & y_b
            \end{pmatrix} \neq 0,
  \] так как в случае равенства $0$ в \ref{proof1stsys} основная матрица была бы вырожденной и имела бы ранг, меньший $3$.
  Значит, так как детерминант основной матрицы в \ref{proo2ndsys} не равен 0, она невырождена, и система имеет ровно одно решение по теореме Кронекера-Капелли.
  Лемма доказана.
\end{Proof}

\chapter{Описание алгоритма}
    \section{Вход алгоритма и требования к нему}
      На вход алгоритма поступают цилиндр и параллелепипед в следующем формате.
      Цилиндр задан четырьмя векторами $\vec{o_c}, \vec{a_c}, \vec{b_c}, \vec{c_c}$ в трехмерном афинном пространстве.
      Вектор $\vec{o_c}$ задает центр одного из оснований.
      Вектор $\vec{a_c}$ задает одну из осей эллипса, лежащего в основании.
      Вектор $\vec{b_c}$ задает вторую ось эллипса, лежащего в основании.
      Вектор $\vec{с_c}$ задает направляющую цилиндра.
      Координаты векторов должны быть заданы в ортонормированном базисе.
      Здесь имеется в виду, что программа считает исходный базис ортонормированным.
      Вектора $\vec{a_c}$ и $\vec{b_c}$ ортогональны.
      Вектора $\vec{a_c}$, $\vec{b_c}$ и $\vec{с_c}$ представляют собой линейно независимую систему векторов.

      Параллелепипед задан также четырьмя векторами: $\vec{o_p}, \vec{a_p}, \vec{b_p}, \vec{c_p}$.
      Вектор $\vec{o_c}$ задает одну из вершин.
      Вектора $\vec{a_p}$, $\vec{b_p}$ и $\vec{с_p}$ задают три непараллельных ребра, имеющих общую точку $\vec{o_p}$; эти вектора направлены от вершины $\vec{o_p}$.
      Требование лишь одно: вектора $\vec{a_p}$, $\vec{b_p}$ и $\vec{с_p}$ должны образовывать линейно независимую систему.

      После получения всех параметров при создании объектов соответствующих классов производится проверка требований.
      В случае, если требования не выполнены, программа выдаст сообщение об ошибке.
\section{Преобразование базиса}
      Перенесем начало координат в точку $\vec{o_c}$.
      Вектора $\vec{a_c}$, $\vec{b_c}$ и $\vec{с_c}$ задают базис.
      Для этого базиса матрица перехода естественно определена:
      $N = \begin{pmatrix} {a_c} & {b_c} & c_{c} \end{pmatrix}$.
      Кроме того, введем новое скалярное произведение, определив матрицу Грама в новом базисе как единичную.
      Таким образом, в новом базисе цилиндр с внутреннотью задан системой неравенств
      \begin{equation}\label{cnb}
          \begin{cases}
          x^2 + y^2   \le  1  \\
          0 \le  z   \le  1
          \end{cases}
      \end{equation},

      где $\begin{pmatrix} x \\ y \\ z \end{pmatrix}$ --- координаты некоторой точки в новом базисе.

      В новом базисе легко получим координаты для векторов, задающих параллелепипед.
      Для $\vec{o_p}$:
      $\begin{pmatrix} x_o \\ y_o \\ z_o \end{pmatrix} =  N^{-1} (o_p - o_c) $, где $o_p$ и $o_c$ --- коодинаты соответствующих векторов в исходном базисе.

      Для $\vec{a_p}$, $\vec{b_p}$ и $\vec{с_p}$:
      $\begin{pmatrix} x_a & x_b & x_c \\ y_a & y_b & y_c  \\ z_a & z_b & z_c \end{pmatrix} =
      N^{-1} \begin{pmatrix} a_p & b_p  & c_p \end{pmatrix}$

      Параллелепипеду принадлежат точки $\vec{a}$, удовлетворяющие следующим условиям:
      \begin{equation}\label{pvec}
        \begin{cases}
          \vec{a} = \vec{o_p} + \alpha \vec{a_p} + \beta \vec{b_p} + \gamma \vec{c_p} \\
          0 \le  \alpha   \le  1 \\
          0 \le  \beta   \le  1 \\
          0 \le  \gamma   \le  1
        \end{cases}
      \end{equation}

      Перепишем (\ref{pvec}) в координатном виде с координатами, заданными в новом базисе.
      \begin{equation}\label{pcoord}
        \begin{cases}
          \begin{pmatrix} x \\ y \\ z \end{pmatrix}
          =
          \begin{pmatrix} x_o & x_a & x_b & x_c \\ y_o & y_a & y_b & y_c  \\ y_o & z_a & z_b & z_c
          \end{pmatrix} \begin {pmatrix} 1 \\ \alpha \\ \beta \\ \gamma \end{pmatrix} \\
          0 \le  \alpha   \le  1 \\
          0 \le  \beta   \le  1 \\
          0 \le  \gamma   \le  1
        \end{cases}
      \end{equation}

      Таким образом задача сводится к проверке наличия решения у систем (\ref{cnb}) и (\ref{pcoord}.)
\section{Переход к задаче на гранях}
    Поскольку и цилиндр, и параллелепипед --- тела выпуклые, цилиндр или вложен в параллелепипед, или пересекается с гранями параллелепипеда, или не имеет с ним общих точек вовсе.
    Грань параллелепипеда задается, например, следующей системой:
    \begin{equation}\label{planecoord}
      \begin{cases}
        \begin{pmatrix} x \\ y \\ z \end{pmatrix}
        =
        \begin{pmatrix} x_o & x_a & x_b & x_c \\ y_o & y_a & y_b & y_c  \\ y_o & z_a & z_b & z_c
        \end{pmatrix} \begin {pmatrix} 1 \\ \alpha \\ \beta \\ \gamma \end{pmatrix} \\
        0 \le  \alpha   \le  1 \\
        0 \le  \beta   \le  1 \\
        \gamma   =  1
      \end{cases}
    \end{equation}

    Вместо $\gamma$ в 0 или 1 могут обратиться также $\alpha$ и $\beta$.
    Эти замены дадут нам шесть граней параллелепипеда.
\section{Переход к проекции}
    Для каждой грани необходимо установить наличие решение у системы неравенств следующего вида
    \begin{equation}\label{proj}
      \begin{cases}
        x^2 + y^2 \le 1 & (1)\\
        \begin{pmatrix} x \\ y \\ z \end{pmatrix}
        =
        \begin{pmatrix} x_o & x_a & x_b & x_c \\ y_o & y_a & y_b & y_c  \\ y_o & z_a & z_b & z_c
        \end{pmatrix} \begin {pmatrix} 1 \\ \alpha \\ \beta \\ \gamma \end{pmatrix} & (2)\\
        0 \le  \alpha   \le  1 & (3)\\
        0 \le  \beta   \le  1 & (4)\\
        \gamma   =  1 & (5) \\
        0 \le z \le 1 & (6)
      \end{cases}
    \end{equation}
  Правая и левая части (5) могут меняться в зависимости от выбранной грани.
  Будем рассматривать (6) как ограничение не на высоту цилиндра, а на грань.
  Поскольку (6) задает два линейных ограничения на $\alpha, \beta, \gamma$, поиск решения неравенства (1) будет вестись на некотором многоугольнике.
  Итак, ограничение на высоту цилиндра снято и заменено ограничением на грань.
  Так как цилиндр теперь бесконечный по высоте, можем спроецировать обе фигуры на плоскость $xOy$ и проверять на наличие пересечений выпуклый многоугольник и круг.
  Если они пересекаются, то либо точка пересечения лежит на ребре многоугольника, либо точек пересечения на ребрах нет, но центр круга лежит внутри многоугольника (см. Лемму~\ref{conv}).
  Проверим оба варианта.
\section{Перход к задаче квадратичного программирования}
    Подставим равенство из (\ref{planecoord}) в (\ref{cnb}) и добавим туда же неравенства из (\ref{planecoord}).
    Для этого произведем некоторые дополнительные преобразования.
    \[
      x^2 = \begin{pmatrix} x_o & x_a & x_b & x_c \end{pmatrix}
             \begin{pmatrix} 1 \\ \alpha \\ \beta \\ \gamma \end{pmatrix}
             \begin{pmatrix} x_o & x_a & x_b & x_c \end{pmatrix}
             \begin{pmatrix} 1 \\ \alpha \\ \beta \\ \gamma \end{pmatrix}
    \]
    Пусть $r = \begin{pmatrix} 1 \\ \alpha \\ \beta \\ \gamma \end{pmatrix} $,
          $v = \begin{pmatrix} x_o & x_a & x_b & x_c \end{pmatrix}$.
    Тогда
    \[
      x^2 = v r v r = (r^T v^T)^T v r
    \]
    Но $r^T v^T$ имеет размерность $1x1$, поэтому от транспонирования можно избавиться.
    \[
      x^2 = r^T (v^T v) r
    \]\[
      X_4 = (v^T v)
    \]
    Заметим, что $X_4$ задает квадратичную форму, эта матрица симметрична и вдобавок положительно определена.
    Мы помним, что в столбце $r$ есть две константы: $1$ и $\gamma$.
    Вынесем их из столбца, а соответствующие коэффициенты --- из формы.
    \[
      x^2 = r^T X_4 r =
        \begin{pmatrix} 1 & \alpha & \beta & \gamma \end{pmatrix}
        \begin{pmatrix}
              a_{11} & a_{12} & a_{13} & a_{14} \\
              a_{21} & a_{22} & a_{23} & a_{24} \\
              a_{31} & a_{32} & a_{33} & a_{34} \\
              a_{41} & a_{42} & a_{43} & a_{44} \\

        \end{pmatrix}
        \begin{pmatrix} 1 \\ \alpha \\ \beta \\ \gamma \end{pmatrix}  =
    \]\[
        = a_{11} + 2a_{12}\alpha + 2a_{13}\beta + 2a_{14}\gamma +
                 a_{22}\alpha^2 + 2a_{23}\alpha\beta + 2a_{24}\alpha\gamma +
                                  a_{33}\beta^2 + 2a_{34}\beta\gamma +
                                                  a_{44}\gamma^2  =
    \]\[
        = \begin{pmatrix} \alpha & \beta \end{pmatrix}
          \begin{pmatrix}
              a_{22} & a_{23} \\
              a_{32} & a_{33}
        \end{pmatrix}
        \begin{pmatrix} \alpha \\ \beta \end{pmatrix}
    %\]\[
      + \begin{pmatrix} 1 & \gamma \end{pmatrix}
          \begin{pmatrix}
              a_{11} & a_{14} \\
              a_{14} & a_{44}
        \end{pmatrix}
        \begin{pmatrix} 1 \\ \gamma \end{pmatrix}
      + 2\begin{pmatrix} 1 & \gamma \end{pmatrix}
          \begin{pmatrix}
              a_{12} & a_{13} \\
              a_{24} & a_{34}
        \end{pmatrix}
        \begin{pmatrix} \alpha \\ \beta \end{pmatrix}
    \]
    Введем обозначения для константы и составленных из констант матриц:

        $X_2 = \begin{pmatrix}
              a_{22} & a_{23} \\
              a_{32} & a_{33}
        \end{pmatrix}$,

        $b_X = 2\begin{pmatrix} 1 & \gamma \end{pmatrix}
          \begin{pmatrix}
              a_{12} & a_{13} \\
              a_{24} & a_{34}
        \end{pmatrix} =
        \begin{pmatrix}
              a_{12} & a_{13} \\
              a_{42} & a_{43}
        \end{pmatrix}$,

        $C_X = \begin{pmatrix} 1 & \gamma \end{pmatrix}
          \begin{pmatrix}
              a_{11} & a_{14} \\
              a_{14} & a_{44}
        \end{pmatrix}
        \begin{pmatrix} 1 \\ \gamma \end{pmatrix}$.

      Получим, что
      $x^2 = \begin{pmatrix} \alpha && \beta \end{pmatrix}
               X_2
             \begin{pmatrix} \alpha \\ \beta \end{pmatrix} +
             b_X \begin{pmatrix} \alpha \\ \beta \end{pmatrix}  +
             C_X$.

      Для $y^2$ получим аналогичные матрицы $Y_2$, $b_Y$, $C_Y$.

      Квадратичное неравенство из (\ref{cnb}) приведено к следующему виду:

      \begin{equation}\label{ineq}
            \begin{pmatrix} \alpha && \beta \end{pmatrix}
               (X_2 + Y_2)
             \begin{pmatrix} \alpha \\ \beta \end{pmatrix} +
             (b_X + b_Y) \begin{pmatrix} \alpha \\ \beta \end{pmatrix}  \le
             1 - C_X -C_Y
      \end{equation}
      Именно квадратичную функцию из левой части неравенства мы подвергнем условной минимизации.
      Запишем задачу квадратичного программирования.
      \begin{equation}\label{quadrtask}
          \begin{cases}
          \begin{pmatrix} \alpha && \beta \end{pmatrix}
               (X_2 + Y_2)
             \begin{pmatrix} \alpha \\ \beta \end{pmatrix} +
             (b_X + b_Y) \begin{pmatrix} \alpha \\ \beta \end{pmatrix} \to min \\
              0 \le  \alpha   \le  1 \\
              0 \le  \beta   \le  1 \\
              \gamma   =  1 \\
              0 \le  z_o + z_a \alpha + z_b \beta + z_c\gamma   \le  1
          \end{cases}
      \end{equation}
      Равенство $\gamma = 1$ сюда включено, конечно, только для наглядноcти подстановки в последнее неравенство.
      Оно примет вид $ -z_o - z_c \le  z_a \alpha + z_b \beta \le  1 -z_o - z_c$.
      Если минимум, который мы отыщем после оптимизации, будет меньше константы в правой части неравенства (\ref{ineq}), это будет значить наличие пересечения с гранью.
      В противном случае пересечения с этой гранью не будет.

      Итак, мы получили задачу квадратичного программирования для проверки наличия пересечения грани и цилиндра.
      Аналогично получим такие задачи для остальных пяти граней.
      Ниже описано получение из них задачи квадратичного программирования для ребре.
\section{Постановка задачи минимизации на ребре многоугольника}
  В (\ref{quadrtask}) включены три двойных неравенства.
  Их можно разбить и получить шесть простых.
  Обращая их в равенства, получим для некоторых уравнения прямых, содержащих в себе ребра многогранника.
  Некоторые прямые не содержат в себе ни одного ребра и вообще не проходят через многоугольник.
  Точки минимума, найденные на таких прямых, не будут учитываться; как они будут отсеяны, описано ниже.
  В общем случае задача квадратичного программирования для ребра поставлена так:
  \begin{equation}\label{task1dim}
          \begin{cases}
          \begin{pmatrix} \alpha && \beta \end{pmatrix}
               M
             \begin{pmatrix} \alpha \\ \beta \end{pmatrix} +
             b \begin{pmatrix} \alpha \\ \beta \end{pmatrix} \to min &(1) & (1)\\
             k \alpha + m \beta = C_1 & (2) \\
             0 \le  \alpha   \le  1  \\
             0 \le  \beta   \le  1  &(3)\\
              -z_o - z_c \le  z_a \alpha + z_b \beta \le  1 -z_o - z_c
          \end{cases}
      \end{equation}
  Здесь $k, m, C_1$ --- некоторые константы,
  $f$ --- линейное преобразование двух аргументов, возвращающее столбец из нескольких действительных чисел,
  а $C_2$ --- столбец той же размерности;
  $f(\alpha, \beta) \le C_2$ выполнено тогда и только тогда, когда каждая компонента $f(\alpha, \beta)$ не превосходит соответствующей компоненты $C_2$.
\section{Решение задачи минимизации на ребре многоугольника}
  Пусть $M = \begin{pmatrix} m_{11} & m_{12} \\ m_{21} & m_{22} \end{pmatrix}$,
        $b = \begin{pmatrix} b_1 && b_2 \end{pmatrix}$.
  Заменим в системе линейных уравнений $2M \begin{pmatrix} \alpha \\ \beta \end{pmatrix} = - b^T$ одну из строк на $\begin{pmatrix} k & m & C_1 \end{pmatrix}$,
  причем если $k=0$, заменим вторую строку, а иначе --- первую.
  Можем получить одну из следующих систем:
  \[
    \begin{pmatrix}
      k & 0 & \vrule & C_1 \\
      m_{21} & m_{22} & \vrule & b_2
    \end{pmatrix}
    \begin{pmatrix}
      k & m & \vrule & C_1 \\
      m_{21} & m_{22} & \vrule & b_2
    \end{pmatrix}
    \begin{pmatrix}
      m_{11} & m_{12} & \vrule & b_1 \\
      0 & m & \vrule & C_1
    \end{pmatrix}
  \]
  Получившаяся система задает точку минимума формы на прямой (см. Лемму~\ref{chstr4edge}).
  Чтобы проверить, лежит ли она на ребре, подставим ее в условия (3) из (\ref{task1dim}).
  Тут можно заметить, что если прямая не включает в себя ни одного ребра, то есть проходит вне многоугольника,
  эта точка не будет удовлетворять условиям (3) и в итоговую выборку не попадет.
  Если минимум попал на ребро, вернем его.
  В противном случае переберем вершины.
  Для этого будем последовательно обращать неравенства из условий в равенства.
  Получим систему двух линейных уравнений: одно получено при постановке задачи на ребре, второе --- этим обращением в равенство.
  Если получившаяся система несовместная, то она не задает никакой вершины.
  Если же она совместная, то решив ее, получим точку, которая, возможно, является вершиной.
  Если мы включим в рассмотрение точки внутри ребра, они просто не дадут значения формы меньше, вершины.
  Поэтому необходимо из возможных вершин исключить те, что не лежат на ребре.
  Это можно сделать подстановкой в неравенства (3).
  Из оставшихся выберем то, для которой значение формы наименьшее.
  Если такой точки не нашлось, результатом будет ответ о невозможности найти минимум на ребре.
\section{Проверка попадания центра окружности в многоугольник}
  В главе "Переход к проекции" ~ говорилось, что круг может не иметь пересечения с ребром многоугольника,
  и, тем не менее, иметь пересечение с внутренней частью, если центр круга лежит внутри многоугольника.
  Наличие пересечения круга с ребрами было проверено в предыдущей части;
  теперь проверим принадлежность центра круга многоугольнику.
  Центр круга имеет координаты $(0, 0)$ на плоскости $xOy$.
  Подставим их в систему линейных уравнений (2) из системы \ref{proj}.
  В качестве третьего уравнения подставим (5).
  Получим
  \[
    \begin{pmatrix}
     x_a & x_b & x_c & \vrule & -x_o\\
     y_a & y_b & y_c & \vrule & -y_o \\
     0   & 0   & 1   & \vrule & 1
     \end{pmatrix}
  \]
  Полученная система уравнений будет иметь единственное решение (см. Лемму \ref{chstr4check}).
  Решив ее, найдем $\alpha, \beta, \gamma$.
  Полученные значения подставим в неравенства (3), (4), (6).
  Если они удовлетворяют неравенству, центр круга лежит внутри многоугольника.
\section{Финальные проверки}
  Итак, найдены наименьшие значения форм на всех гранях. Это либо наименьшие из значений на ребрах, либо $0$, если центр круга попал внутрь многоугольника.
  Их необходимо сравнить с соответствующей константой в правой части (\ref{ineq}).
  Если хотя бы одно из наименьших значениях оказалось не больше константы, то точка пересечения найдена.
  Если все они превосходят константу, возможно, цилиндр вложен в параллелепипед.
  Проверим это.
  Для этого просто проверим, принадлежит ли точка $\begin{pmatrix}0 \\ 0 \\ 0 \end{pmatrix}$ параллелепипеду.
  Сделаем это, решив систему линейных уравнений
  \[
    \begin{pmatrix}
     x_a & x_b & x_c & \vrule & -x_o\\
     y_a & y_b & y_c & \vrule & -y_o \\
     z_a & z_b & z_c & \vrule & -z_o
     \end{pmatrix}
  \]
  Если его решение $\begin{pmatrix} \alpha \\ \beta \\ \gamma \end{pmatrix}$ такого, что все компоненты лежат между $0$ и $1$, начало координат попало в пареллелепипед, а значит, попал и весь цилиндр. Если нет, то значит, что точек пересечения у тел нет.
  Последнюю проверку можно было бы проводить и в самом начале, до решения задачи квадратичного программирования на гранях.
\clearpage




\end{document}
